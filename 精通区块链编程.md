# 精通区块链编程

## 比特币介绍

比特币既是构成数字货币生态系统基础概念和技术的总称，又是比特币网络参与者存储和传输的货币单位
比特币是分布式的点对点的系统，比特币是通过挖矿的流程创造出来的
挖矿流程涉及在打包处理比特币交易过程中矿工竞争式的寻找一个数学问题的解（寻找符合条件的hash值）
比特币挖矿流程代替了中央银行的货币发行和结算功能，通过分布式架构取代中央银行的地位
比特币总数限制在2100w以内

### 比特币的创新

- 去中心化的点对点网络（比特币协议）
- 一本公开的交易总账
- 一套可独立校验交易和发行货币的规则（共识规则）
- 一种通过全球去中心化对有效的区块链达成共识的机制（工作量证明算法）

最关键的创新是使用分布式计算系统（工作量证明算法）每十分钟进行一次全球兴致的“选举”，从而让分布式网络达成关于已经发生交易状态的共识

### 比特币钱包

- 比特币系统常见的用户界面
- 常见的三种钱包：桌面全节点客户端、手机轻量级钱包、网络第三发钱包

私钥

比特币地址

比特币交易是不可撤销的

## 比特币工作原理

交易、区块、挖矿和区块链

**比特币系统**由用户、交易和矿工三方构成，用户使用包含秘钥的钱包、交易在整个网络传播、矿工则生产（通过竞争性计算）出共识性区块链，也就是所有交易的公共权威账本

**比特币交易** 一笔交易是告知全网这部分比特币持有者已经授权把它转给新的持有者，新的持有者可以创造新的交易花掉所持有的的比特币，而这笔交易又再次将比特币授权给另一位持有者，形成一条所有者的链表

许多比特币交易包含指向新的持有者的地址和现持有者的地址，被称作“找零”地址

钱包应用可以在离线时建立交易

比特币交易不需要连接比特币网络的时候建立和签署

一个运行**全节点客户端**的比特币钱包实际上包含整个区块链上每笔交易的未消费输出和副本，这使得一个钱包既能构建交易输入，又能基于正确的输入快速验证收到的新交易，然而全节点客户端会使用大量的硬盘空间，大多数用户钱包使用轻量级客户端，只维护自己未消费的输出。

**交易的输出**以脚本的形式被创建，它设置对兑换价值的保护，只能通过引导对这个脚本的解答才能兑换。

交易费用作为矿工检验交易、包括到一个区块并记录在区块链上的费用

区块链网络的目的是将交易和区块传播给所有参与者

传播：任何收到了之前没见过的有效交易的比特币节点，会立即想连在它之上的所有节点转发，这个传播技巧叫做泛滥。

**比特币挖矿** 通过挖矿的过程被检验并被包括到一个区块之中，才会成为区块链的一部分。

打包过程需要大量计算来证明，检验仅需要很少的计算量

挖矿的作用

- 挖矿节点通过参考比特币的共识规则检验所有交易，挖矿通过拒绝无效或者不正常的交易为比特币交易提供安全保证
- 挖矿在构建区块是会创造新的比特币，类似中央银行引发新纸币，每个区块创造的比特币的数量是有限的，并按照随着时间减少的固定发行规则。

挖矿在成本和汇报之间达成平衡，使用电力解决数学问题。矿工通过新的比特币和交易手续费获取回报，矿工只有按照共识规则正确验证所有交易之后才会获得回报，这种平衡在没有中央权威的情况下为比特币提供了安全保证。

**工作量证明算法**需要重复对区块的头和一个随机数使用sha256加密算法计算哈希值直到出现预定匹配的解答，第一个找到解答的矿工赢得这一轮，并将得到的区块发布到区块链上。

**挖掘交易**

新的交易流入网络，当被比特币网络节点看到时，便会被加到每个节点维护的未验证的临时池子，当打包新块时，会从临时的池子里选择未验证的交易加入新区块，使用工作量证明算法来证明新块的有效性

交易加入到区块，会按照手续费和其他条件排序，每个矿工从网络收到之前的区块时，便知道自己输掉了上一轮，开始新的挖掘，创建新的区块，填入交易和之前区块的指纹，进行下一轮。

区块一个叠一个，逆转交易的难度将指数级增加，从而让他变得更加被网络信任。

每个比特币客户端可独立验证交易是合法的和可消费的

## 核心客户端

## 密钥和地址

## 钱包